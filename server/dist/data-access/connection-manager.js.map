{"version":3,"sources":["../../src/data-access/connection-manager.js"],"names":[],"mappings":"AAAA;;AAEA,IAAI,cAAc,QAAQ,SAAR,EAAmB,WAArC;AAAA,IACE,YAAY,QAAQ,cAAR,CADd;;AAGA,IAAI,UAAU;AACZ,WAAS,OADG;AAEZ,SAAO;AAFK,CAAd;;AAKA,IAAI,6BAAJ;;AAEA,SAAS,OAAT,CAAkB,gBAAlB,EAAoC;AAClC,SAAO,IAAI,OAAJ,CAAY,UAAC,OAAD,EAAU,MAAV,EAAqB;AACtC,QAAI,UAAU,EAAd,EAAkB;AAChB,aAAO,OAAO,2BAAP,CAAP;AACD;AACD,QAAI,oBAAJ,EAA0B;;AAExB,aAAO,OAAO,mCAAP,CAAP;AACD;;AAED,2BAAuB,YAAY,OAAZ,CAAoB,gBAApB,EAAsC,UAAU,GAAV,EAAe,EAAf,EAAmB;AAC9E,gBAAU,EAAV,GAAe,EAAf;AACA;AACD,KAHsB,CAAvB;AAID,GAbM,CAAP;AAcD;;AAED,SAAS,eAAT,GAA4B;AAC1B,SAAO,IAAI,OAAJ,CAAY,UAAC,OAAD,EAAU,MAAV,EAAqB;AACtC,WAAO,UAAU,EAAjB;AACA,yBAAqB,KAArB,CAA2B,eAAO;AAChC,UAAI,GAAJ,EAAS;AACP;AACD,OAFD,MAEO;AACL,+BAAuB,IAAvB;AACA;AACD;AACF,KAPD;AAQD,GAVM,CAAP;AAWD;;AAED,OAAO,OAAP,GAAiB,OAAjB","file":"connection-manager.js","sourcesContent":["'use strict';\n\nlet MongoClient = require('mongodb').MongoClient,\n  dbManager = require('./db-manager');\n\nlet manager = {\n  connect: connect,\n  close: closeConnection\n};\n\nlet connectedMongoClient;\n\nfunction connect (connectionString) {\n  return new Promise((resolve, reject) => {\n    if (dbManager.db) {\n      return reject('connection already exists');\n    }\n    if (connectedMongoClient) {\n      // TODO - I'm not sure about this\n      return reject('connection attempt already exists');\n    }\n    // TODO - check configuration - authentication;\n    connectedMongoClient = MongoClient.connect(connectionString, function (err, db) {\n      dbManager.db = db;\n      resolve();\n    });\n  });\n}\n\nfunction closeConnection () {\n  return new Promise((resolve, reject) => {\n    delete dbManager.db;\n    connectedMongoClient.close(err => {\n      if (err) {\n        reject();\n      } else {\n        connectedMongoClient = null;\n        resolve();\n      }\n    });\n  });\n}\n\nmodule.exports = manager;"]}